---
layout: post
title: "TCP三次握手和四次挥手"
description: "TCP三次握手和四次挥手"
categories: [TCP/IP,Interview]
tags: [TCP/IP]
redirect_from:
  - /2018/4/18/
---

> 本文主要讲解TCP协议建立连接("3次握手")和断开连接("4次挥手")的过程

* Kramdown table of contents
{:toc .toc}

# TCP和UDP简介
TCP和UDP是TCP/IP协议簇传输层的协议工作在OSI的第四层
* TCP是面向连接的可靠的传输协议，有确认机制，重传机制，滑动窗口等
* UDP是无连接的尽最大努力的交付，应用层面来确保可靠性


# TCP报文格式
![smiley](https://img-blog.csdn.net/20140609125220296?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYTE5ODgxMDI5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)


* 重点字段介绍
	* 1.序号：Seq序号，占32位，用来表示从TCP源端向目的端发送的数据流，发起方发送数据时对此进行标记
	* 2.确认序号：Ack序号，占32位，只有ACK标志为1时，确认序号字段才有效，Ack=Seq+1
	* 3.标志位：共6个，即URG，ACK，PSH，RST，SYN，FIN等，具体含义如下：
		* URG：紧急指针有效
		* ACK：确认序号有效
		* PSH：接收方应该尽快将这个报文交给应用层
		* RST：连接重置
		* SYN：发起一个新连接
		* FIN：释放一个连接

> * 需要注意:
>   * 不要将确认序号Ack与标志位中的ACK搞混了
>   * 确认方Ack=发起方Req+1，两端配对